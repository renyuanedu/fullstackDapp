{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nvar __jsx = React.createElement;\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function () { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React, { Component } from 'react';\nimport { Form, Input, Button, Message } from 'semantic-ui-react';\nimport Layout from '../../../components/layout';\nimport Campaign from '../../../ethernum/campaign';\nimport web3 from '../../../ethernum/web3';\nimport { Router, Link } from '../../../routes';\n\nvar CompaignNew = /*#__PURE__*/function (_Component) {\n  _inherits(CompaignNew, _Component);\n\n  var _super = _createSuper(CompaignNew);\n\n  function CompaignNew() {\n    var _this;\n\n    _classCallCheck(this, CompaignNew);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      description: '',\n      errorMessage: '',\n      value: '',\n      reciptientAddress: ''\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onSunbmit\", function _callee() {\n      var campaign, accounts, _this$state, description, value, reciptientAddress;\n\n      return _regeneratorRuntime.async(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              event.preventDefault();\n              campaign = Campaign(_this.props.address);\n              _context.next = 4;\n              return _regeneratorRuntime.awrap(web3.eth.getAccounts());\n\n            case 4:\n              accounts = _context.sent;\n              _this$state = _this.state, description = _this$state.description, value = _this$state.value, reciptientAddress = _this$state.reciptientAddress;\n\n              _this.setState({\n                loading: true\n              });\n\n              _context.prev = 7;\n              _context.next = 10;\n              return _regeneratorRuntime.awrap(campaign.methods.createRequest(description, web3.utils.toWei(value, 'ether'), reciptientAddress).send({\n                from: accounts[0]\n              }));\n\n            case 10:\n              Router.pushRoute(\"/compaigns/\".concat(_this.props.address, \"/requests\"));\n              _context.next = 16;\n              break;\n\n            case 13:\n              _context.prev = 13;\n              _context.t0 = _context[\"catch\"](7);\n\n              _this.setState({\n                errorMessage: _context.t0.message\n              });\n\n            case 16:\n              _this.setState({\n                loading: false\n              });\n\n            case 17:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, null, [[7, 13]], Promise);\n    });\n\n    return _this;\n  }\n\n  _createClass(CompaignNew, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      return __jsx(Layout, null, __jsx(Link, {\n        route: \"/compaigns/\".concat(this.props.address, \"/requests\")\n      }, __jsx(\"a\", null, \"\\u8FD4\\u56DE\")), __jsx(Form, {\n        onSubmit: this.onSubmit,\n        error: !!this.state.errorMessage\n      }, __jsx(Form.Field, null, __jsx(\"label\", null, \"\\u8BF7\\u6C42\\u63CF\\u8FF0\"), __jsx(\"input\", {\n        value: this.state.description,\n        onChange: function onChange(event) {\n          return _this2.setState({\n            value: event.target.description\n          });\n        }\n      })), __jsx(Form.Field, null, __jsx(\"label\", null, \"\\u8BF7\\u6C42\\u91D1\\u989D\"), __jsx(\"input\", {\n        value: this.state.value,\n        onChange: function onChange(event) {\n          return _this2.setState({\n            value: event.target.value\n          });\n        }\n      })), __jsx(Form.Field, null, __jsx(\"label\", null, \"\\u6536\\u76CA\\u4EBA\\u5730\\u5740\"), __jsx(\"input\", {\n        value: this.state.reciptientAddress,\n        onChange: function onChange(event) {\n          return _this2.setState({\n            value: event.target.value\n          });\n        }\n      })), __jsx(Message, {\n        error: true,\n        header: \"\\u9519\\u8BEF\\u63D0\\u793A\",\n        content: this.state.errorMessage\n      }), __jsx(Button, {\n        primary: true,\n        loading: this.state.loading\n      }, \"\\u589E\\u52A0\\u8BF7\\u6C42\")));\n    }\n  }], [{\n    key: \"getInitialProps\",\n    value: function getInitialProps(props) {\n      var address;\n      return _regeneratorRuntime.async(function getInitialProps$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              address = props.query.address;\n              return _context2.abrupt(\"return\", {\n                address: address\n              });\n\n            case 2:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    }\n  }]);\n\n  return CompaignNew;\n}(Component);\n\nexport default CompaignNew;","map":{"version":3,"sources":["D:/fullstackDapp/pages/compaigns/requests/new.js"],"names":["React","Component","Form","Input","Button","Message","Layout","Campaign","web3","Router","Link","CompaignNew","description","errorMessage","value","reciptientAddress","event","preventDefault","campaign","props","address","eth","getAccounts","accounts","state","setState","loading","methods","createRequest","utils","toWei","send","from","pushRoute","message","onSubmit","target","query"],"mappings":"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","sourcesContent":["import React,{Component} from 'react';\nimport { Form,Input,Button,Message } from 'semantic-ui-react';\nimport Layout from '../../../components/layout';\nimport Campaign from '../../../ethernum/campaign';\nimport web3 from '../../../ethernum/web3';\nimport {Router,Link} from '../../../routes';\n\nclass CompaignNew extends Component{\n\n state={\n   description:'',\n   errorMessage:'',\n   value:'',\n   reciptientAddress:''\n\n };\n\n static async getInitialProps(props){\n   const {address} = props.query;\n   return {address};\n }\n\n\n onSunbmit= async()=>{\n   event.preventDefault();\n   const campaign = Campaign(this.props.address);\n   const accounts = await web3.eth.getAccounts();\n   const {description,value,reciptientAddress} = this.state;\n   this.setState({loading:true});\n\n   try{\n     await campaign.methods.createRequest(description,web3.utils.toWei(value,'ether'),reciptientAddress).send({\n       from:accounts[0]\n\n     });\n     Router.pushRoute(`/compaigns/${this.props.address}/requests`)\n   }catch(err){\n     this.setState({errorMessage:err.message});\n   }\n   this.setState({loading:false});\n }\n\n  render(){\n\n\n    return(\n      <Layout>\n      <Link route={`/compaigns/${this.props.address}/requests`}>\n       <a>返回</a>\n      </Link>\n      <Form onSubmit={this.onSubmit} error={!!this.state.errorMessage}>\n        <Form.Field>\n         <label>请求描述</label>\n         <input\n           value={this.state.description}\n           onChange={event=>this.setState({value:event.target.description})}\n\n           />\n        </Form.Field>\n\n        <Form.Field>\n         <label>请求金额</label>\n         <input\n           value={this.state.value}\n           onChange={event=>this.setState({value:event.target.value})}\n\n           />\n        </Form.Field>\n\n        <Form.Field>\n         <label>收益人地址</label>\n         <input\n           value={this.state.reciptientAddress}\n           onChange={event=>this.setState({value:event.target.value})}\n\n           />\n        </Form.Field>\n\n        <Message error header=\"错误提示\" content={this.state.errorMessage}/>\n        <Button primary loading={this.state.loading}>增加请求</Button>\n      </Form>\n      </Layout>\n    );\n  }\n}\n\nexport default CompaignNew;\n"]},"metadata":{},"sourceType":"module"}