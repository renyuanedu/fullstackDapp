{"ast":null,"code":"var __jsx = React.createElement;\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React, { Component } from \"react\";\nimport { Form, Input, Button, Message } from \"semantic-ui-react\";\nimport Campaign from \"../ethereum/campaign\";\nimport web3 from \"../ethereum/web3\";\nimport { Router } from \"../routes\";\n\nclass ContributeFrom extends Component {\n  constructor(...args) {\n    super(...args);\n\n    _defineProperty(this, \"state\", {\n      value: \"\",\n      errorMessage: \"\",\n      loading: false\n    });\n\n    _defineProperty(this, \"onSubmit\", async () => {\n      event.preventDefault(); //构建合约的实例\n\n      const campaign = Campaign(this.props.address);\n      const accounts = await web3.eth.getAccounts();\n      this.setState({\n        loading: true\n      });\n\n      try {\n        await campaign.methods.contribute().send({\n          from: accounts[0],\n          value: web3.utils.toWei(this.state.value, \"ether\")\n        });\n        Router.replaceRoute(`/compaigns/${this.props.address}`);\n      } catch (error) {\n        this.setState({\n          errorMessage: error.message\n        });\n      }\n\n      this.setState({\n        loading: false\n      });\n    });\n  }\n\n  render() {\n    return __jsx(Form, {\n      onSubmit: this.onSubmit,\n      error: !!this.state.errorMessage\n    }, __jsx(Form.Field, null, __jsx(\"label\", null, \"\\u603B\\u7684\\u6295\\u8D44\\u989D\\u5EA6\"), __jsx(Input, {\n      value: this.state.value,\n      onChange: event => this.setState({\n        value: event.target.value\n      }),\n      label: \"ether\",\n      labelPosition: \"right\"\n    })), __jsx(Message, {\n      error: true,\n      header: \"\\u9519\\u8BEF\\u63D0\\u793A\",\n      content: this.state.errorMessage\n    }), __jsx(Button, {\n      loading: this.state.loading,\n      primary: true\n    }, \"\\u6295\\u8D44\"));\n  }\n\n}\n\nexport default ContributeFrom;","map":{"version":3,"sources":["D:/fullstackDapp/components/contributeForm.js"],"names":["React","Component","Form","Input","Button","Message","Campaign","web3","Router","ContributeFrom","value","errorMessage","loading","event","preventDefault","campaign","props","address","accounts","eth","getAccounts","setState","methods","contribute","send","from","utils","toWei","state","replaceRoute","error","message","render","onSubmit","target"],"mappings":";;;;AAAA,OAAOA,KAAP,IAAcC,SAAd,QAA8B,OAA9B;AAEA,SAAQC,IAAR,EAAaC,KAAb,EAAmBC,MAAnB,EAA0BC,OAA1B,QAAwC,mBAAxC;AAEA,OAAOC,QAAP,MAAqB,sBAArB;AAEA,OAAOC,IAAP,MAAiB,kBAAjB;AAEA,SAAQC,MAAR,QAAqB,WAArB;;AACA,MAAMC,cAAN,SAA6BR,SAA7B,CAAsC;AAAA;AAAA;;AAAA,mCAC5B;AACNS,MAAAA,KAAK,EAAG,EADF;AAENC,MAAAA,YAAY,EAAC,EAFP;AAGNC,MAAAA,OAAO,EAAC;AAHF,KAD4B;;AAAA,sCAM3B,YAAS;AAChBC,MAAAA,KAAK,CAACC,cAAN,GADgB,CAEhB;;AACA,YAAMC,QAAQ,GAAGT,QAAQ,CAAC,KAAKU,KAAL,CAAWC,OAAZ,CAAzB;AACA,YAAMC,QAAQ,GAAG,MAAMX,IAAI,CAACY,GAAL,CAASC,WAAT,EAAvB;AACA,WAAKC,QAAL,CAAc;AAACT,QAAAA,OAAO,EAAC;AAAT,OAAd;;AACA,UAAG;AACC,cAAMG,QAAQ,CAACO,OAAT,CAAiBC,UAAjB,GAA8BC,IAA9B,CAAmC;AACzCC,UAAAA,IAAI,EAACP,QAAQ,CAAC,CAAD,CAD4B;AAEzCR,UAAAA,KAAK,EAACH,IAAI,CAACmB,KAAL,CAAWC,KAAX,CAAiB,KAAKC,KAAL,CAAWlB,KAA5B,EAAkC,OAAlC;AAFmC,SAAnC,CAAN;AAIFF,QAAAA,MAAM,CAACqB,YAAP,CAAqB,cAAa,KAAKb,KAAL,CAAWC,OAAQ,EAArD;AACD,OAND,CAMC,OAAMa,KAAN,EAAY;AACX,aAAKT,QAAL,CAAc;AAACV,UAAAA,YAAY,EAACmB,KAAK,CAACC;AAApB,SAAd;AACD;;AACH,WAAKV,QAAL,CAAc;AAACT,QAAAA,OAAO,EAAC;AAAT,OAAd;AACD,KAtBqC;AAAA;;AAwBpCoB,EAAAA,MAAM,GAAE;AACN,WACE,MAAC,IAAD;AAAM,MAAA,QAAQ,EAAI,KAAKC,QAAvB;AAAiC,MAAA,KAAK,EAAI,CAAC,CAAC,KAAKL,KAAL,CAAWjB;AAAvD,OACE,MAAC,IAAD,CAAM,KAAN,QACE,4DADF,EAEE,MAAC,KAAD;AAAO,MAAA,KAAK,EAAI,KAAKiB,KAAL,CAAWlB,KAA3B;AAAkC,MAAA,QAAQ,EAAIG,KAAK,IAAE,KAAKQ,QAAL,CAAc;AAACX,QAAAA,KAAK,EAACG,KAAK,CAACqB,MAAN,CAAaxB;AAApB,OAAd,CAArD;AAAgG,MAAA,KAAK,EAAC,OAAtG;AAA8G,MAAA,aAAa,EAAC;AAA5H,MAFF,CADF,EAKE,MAAC,OAAD;AAAS,MAAA,KAAK,MAAd;AAAe,MAAA,MAAM,EAAC,0BAAtB;AAA6B,MAAA,OAAO,EAAE,KAAKkB,KAAL,CAAWjB;AAAjD,MALF,EAME,MAAC,MAAD;AAAQ,MAAA,OAAO,EAAE,KAAKiB,KAAL,CAAWhB,OAA5B;AAAqC,MAAA,OAAO;AAA5C,sBANF,CADF;AAUD;;AAnCmC;;AAsCtC,eAAeH,cAAf","sourcesContent":["import React,{Component} from \"react\";\n\nimport {Form,Input,Button,Message} from \"semantic-ui-react\";\n\nimport Campaign from \"../ethereum/campaign\";\n\nimport web3 from \"../ethereum/web3\";\n\nimport {Router} from \"../routes\";\nclass ContributeFrom extends Component{\n  state = {\n    value : \"\",\n    errorMessage:\"\",\n    loading:false\n  };\nonSubmit = async()=>{\n    event.preventDefault();\n    //构建合约的实例\n    const campaign = Campaign(this.props.address);\n    const accounts = await web3.eth.getAccounts();\n    this.setState({loading:true});\n    try{\n        await campaign.methods.contribute().send({\n        from:accounts[0],\n        value:web3.utils.toWei(this.state.value,\"ether\")\n      });\n      Router.replaceRoute(`/compaigns/${this.props.address}`);\n    }catch(error){\n      this.setState({errorMessage:error.message});\n    }\n  this.setState({loading:false});\n}\n\n  render(){\n    return(\n      <Form onSubmit = {this.onSubmit} error = {!!this.state.errorMessage}>\n        <Form.Field>\n          <label>总的投资额度</label>\n          <Input value = {this.state.value} onChange = {event=>this.setState({value:event.target.value})} label=\"ether\" labelPosition=\"right\"/>\n        </Form.Field>\n        <Message error header=\"错误提示\" content={this.state.errorMessage}/>\n        <Button loading={this.state.loading} primary>投资</Button>\n      </Form>\n    );\n  }\n}\n\nexport default ContributeFrom;"]},"metadata":{},"sourceType":"module"}